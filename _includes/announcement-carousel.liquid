{%- comment -%}
  Announcement Carousel/Banner
  Displays important announcements on the homepage as a carousel/banner.
  Reads from news items with announce: true
{%- endcomment -%}

{%- assign announcements = site.news | where: "announce", true | sort: "date" | reverse -%}

{%- if announcements.size > 0 -%}
  <div class="announcement-carousel-wrapper">
    <div class="announcement-carousel">
      <div class="swiper announcement-swiper">
        <div class="swiper-wrapper">
          {%- for item in announcements -%}
            <div class="swiper-slide">
              <a href="{% if item.link %}{{ item.link | relative_url }}{% else %}{{ item.url | relative_url }}{% endif %}" class="announcement-item">
                <div class="announcement-content">
                  {%- if item.icon -%}
                    <div class="announcement-icon">
                      <i class="{{ item.icon }}"></i>
                    </div>
                  {%- endif -%}
                  <div class="announcement-text">
                    {%- if item.badge -%}
                      <span class="announcement-badge">{{ item.badge }}</span>
                    {%- endif -%}
                    <span class="announcement-title">{{ item.title }}</span>
                    {%- if item.speaker -%}
                      <span class="announcement-speaker">{{ item.speaker }}</span>
                    {%- endif -%}
                    <span class="announcement-date">{% if item.event_date != blank %}{{ item.event_date | date: "%B %d, %Y" }}{% else %}{{ item.date | date: "%B %d, %Y" }}{% endif %}</span>
                  </div>
                  <div class="announcement-arrow">
                    <i class="fas fa-arrow-right"></i>
                  </div>
                </div>
              </a>
            </div>
          {%- endfor -%}
        </div>
        {%- if announcements.size > 1 -%}
          <div class="swiper-pagination announcement-pagination"></div>
        {%- endif -%}
      </div>
    </div>
  </div>

  <style>
    .announcement-carousel-wrapper {
      margin-bottom: 1.5rem;
    }

    .announcement-carousel {
      background: linear-gradient(135deg, var(--global-theme-color) 0%, color-mix(in srgb, var(--global-theme-color) 70%, black) 100%);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
    }

    .announcement-swiper {
      padding: 0;
    }

    .announcement-item {
      display: flex;
      align-items: center;
      padding: 1rem 1.5rem;
      color: white;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .announcement-item:hover {
      background: rgba(255, 255, 255, 0.15);
      color: white;
      text-decoration: none;
    }

    .announcement-content {
      display: flex;
      align-items: center;
      width: 100%;
      gap: 1rem;
    }

    .announcement-icon {
      font-size: 1.5rem;
      opacity: 0.95;
      color: white;
    }

    .announcement-text {
      flex: 1;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.5rem 1rem;
    }

    .announcement-badge {
      background: rgba(255, 255, 255, 0.25);
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: white;
    }

    .announcement-title {
      font-weight: 600;
      font-size: 1rem;
      color: white;
    }

    .announcement-date {
      font-size: 0.85rem;
      opacity: 0.9;
      color: rgba(255, 255, 255, 0.9);
    }

    .announcement-speaker {
      font-size: 0.85rem;
      opacity: 0.9;
      color: rgba(255, 255, 255, 0.9);
      font-style: italic;
    }

    .announcement-arrow {
      opacity: 0.85;
      transition: transform 0.3s ease
      , opacity 0.3s ease;
      color: white;
    }

    .announcement-item:hover .announcement-arrow {
      transform: translateX(4px);
      opacity: 1;
    }

    .announcement-pagination {
      position: relative;
      bottom: 0 !important;
      padding: 0.5rem 0;
    }

    .announcement-pagination .swiper-pagination-bullet {
      background: rgba(255, 255, 255, 0.5);
      opacity: 1;
    }

    .announcement-pagination .swiper-pagination-bullet-active {
      background: white;
    }

    @media (max-width: 768px) {
      .announcement-item {
        padding: 0.875rem 1rem;
      }

      .announcement-text {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.25rem;
      }

      .announcement-title {
        font-size: 0.9rem;
      }
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      if (typeof Swiper !== 'undefined') {
    new Swiper('.announcement-swiper', {
      loop: true,
      autoplay: {
        delay: 5000,
        disableOnInteraction: false,
      },
      pagination: {
        el: '.announcement-pagination',
        clickable: true,
      },
    });
      }
    });
  </script>
{%- endif -%}
{%- comment -%}
  Course Materials Page
  
  A minimal, Apple-inspired layout for displaying course content.
  Uses the modular _teaching.scss design system.
{%- endcomment -%}

{%- assign course_data = site.data.teaching | where: "course_id", page.course_id | first -%}

<div class="course-wrapper">
  <div class="container-md py-4">

    <!-- Course Header -->
    <header class="course-header fade-in">
      <p class="course-header__desc t-body">{{ course_data.description }}</p>
      
      <div class="course-header__meta cluster cluster--sm">
        {%- if course_data.instructor -%}
        <span class="pill pill--accent">
          <i class="fas fa-user"></i>
          {{ course_data.instructor }}
        </span>
        {%- endif -%}
        
        {%- if course_data.semester -%}
        <span class="pill pill--muted">
          <i class="fas fa-calendar"></i>
          {{ course_data.semester }}
        </span>
        {%- endif -%}
        
        {%- if course_data.teaching_assistants and course_data.teaching_assistants.size > 0 -%}
        <span class="pill pill--muted">
          <i class="fas fa-users"></i>
          TAs: {{ course_data.teaching_assistants | join: ", " }}
        </span>
        {%- endif -%}
      </div>
    </header>

    <!-- Schedule Section -->
    {%- if page.schedule -%}
    <section class="content-section fade-in">
      <div class="section-label">
        <div class="section-label__icon">
          <i class="fas fa-clock"></i>
        </div>
        <span class="section-label__text">Schedule</span>
      </div>

      <div class="minimal-card minimal-card--elevated">
        <!-- Logistics Grid -->
        <div class="logistics-grid">
          {%- if page.schedule.dates_time -%}
          <div class="logistics-item">
            <span class="logistics-item__label t-overline">Date & Time</span>
            <span class="logistics-item__value t-body">{{ page.schedule.dates_time }}</span>
          </div>
          {%- endif -%}
          
          {%- if page.schedule.classroom -%}
          <div class="logistics-item">
            <span class="logistics-item__label t-overline">Classroom</span>
            <span class="logistics-item__value t-body">{{ page.schedule.classroom }}</span>
          </div>
          {%- endif -%}
          
          {%- if page.schedule.duration -%}
          <div class="logistics-item">
            <span class="logistics-item__label t-overline">Duration</span>
            <span class="logistics-item__value t-body">{{ page.schedule.duration }}</span>
          </div>
          {%- endif -%}
        </div>

        <!-- Schedule Table -->
        {%- if page.schedule_details -%}
        <div class="schedule-table-wrapper">
          <table class="schedule-table">
            <thead>
              <tr>
                <th>No.</th>
                <th>Date</th>
                <th>Topic / Venue</th>
              </tr>
            </thead>
            <tbody>
              {%- for session in page.schedule_details -%}
              <tr>
                <td><span class="lecture-num">#{{ session.lecture }}</span></td>
                <td>{{ session.date }}</td>
                <td>{{ session.venue }}</td>
              </tr>
              {%- endfor -%}
            </tbody>
          </table>
        </div>
        {%- endif -%}
      </div>
    </section>
    {%- endif -%}

    <!-- Lectures Section -->
    {%- if page.lectures and page.lectures.size > 0 -%}
    <section class="content-section fade-in">
      <div class="section-label">
        <div class="section-label__icon section-label__icon--blue">
          <i class="fas fa-book-open"></i>
        </div>
        <span class="section-label__text">Lectures</span>
      </div>

      <div class="teaching-grid teaching-grid--materials">
        {%- for lecture in page.lectures -%}
        <article class="material-card material-card--lecture minimal-card">
          <div class="material-card__content">
            <h4 class="material-card__title t-title">{{ lecture.title }}</h4>
            {%- if lecture.description -%}
            <p class="material-card__desc t-body">{{ lecture.description }}</p>
            {%- endif -%}
          </div>
          
          <div class="material-card__actions">
            {%- if lecture.slides -%}
            <a href="{{ lecture.slides }}" class="btn-minimal btn-minimal--ghost" target="_blank">
              <i class="fas fa-desktop"></i> Slides
            </a>
            {%- endif -%}
            {%- if lecture.video -%}
            <a href="{{ lecture.video }}" class="btn-minimal btn-minimal--ghost" target="_blank">
              <i class="fas fa-play"></i> Video
            </a>
            {%- endif -%}
            {%- if lecture.notes -%}
            <a href="{{ lecture.notes }}" class="btn-minimal btn-minimal--ghost" target="_blank">
              <i class="fas fa-sticky-note"></i> Notes
            </a>
            {%- endif -%}
          </div>
        </article>
        {%- endfor -%}
      </div>
    </section>
    {%- endif -%}

    <!-- Assignments Section -->
    {%- if page.assignments and page.assignments.size > 0 -%}
    <section class="content-section fade-in">
      <div class="section-label">
        <div class="section-label__icon section-label__icon--green">
          <i class="fas fa-pencil-ruler"></i>
        </div>
        <span class="section-label__text">Assignments</span>
      </div>

      <div class="teaching-grid teaching-grid--materials">
        {%- for assignment in page.assignments -%}
        <article class="material-card material-card--assignment minimal-card">
          <div class="material-card__content">
            <h4 class="material-card__title t-title">{{ assignment.title }}</h4>
            {%- if assignment.description -%}
            <p class="material-card__desc t-body">{{ assignment.description }}</p>
            {%- endif -%}
            {%- if assignment.due_date -%}
            <div class="material-card__due">
              <i class="far fa-clock"></i>
              Due: {{ assignment.due_date }}
            </div>
            {%- endif -%}
          </div>
          
          <div class="material-card__actions">
            {%- if assignment.pdf -%}
            <a href="{{ assignment.pdf }}" class="btn-minimal btn-minimal--subtle" target="_blank">
              <i class="far fa-file-pdf"></i> PDF
            </a>
            {%- endif -%}
            {%- if assignment.solution -%}
            <a href="{{ assignment.solution }}" class="btn-minimal btn-minimal--ghost" target="_blank">
              <i class="fas fa-check"></i> Solution
            </a>
            {%- endif -%}
          </div>
        </article>
        {%- endfor -%}
      </div>
    </section>
    {%- endif -%}

    <!-- Resources Section -->
    {%- if page.resources and page.resources.size > 0 -%}
    <section class="content-section fade-in">
      <div class="section-label">
        <div class="section-label__icon section-label__icon--purple">
          <i class="fas fa-layer-group"></i>
        </div>
        <span class="section-label__text">Resources</span>
      </div>

      <div class="teaching-grid teaching-grid--materials">
        {%- for resource in page.resources -%}
        <article class="material-card material-card--resource minimal-card">
          <div class="material-card__content">
            <h4 class="material-card__title t-title">{{ resource.title }}</h4>
            {%- if resource.description -%}
            <p class="material-card__desc t-body">{{ resource.description }}</p>
            {%- endif -%}
          </div>
          
          <div class="material-card__actions">
            <a href="{{ resource.url }}" class="btn-minimal btn-minimal--primary" target="_blank">
              <i class="fas fa-external-link-alt"></i> Open Resource
            </a>
          </div>
        </article>
        {%- endfor -%}
      </div>
    </section>
    {%- endif -%}

    <!-- Empty State -->
    {%- unless page.lectures or page.assignments or page.resources -%}
    <section class="empty-state fade-in">
      <div class="empty-state__icon">
        <i class="fas fa-book-open"></i>
      </div>
      <h4 class="empty-state__title t-title">Materials Coming Soon</h4>
      <p class="empty-state__desc t-body">Lecture slides, assignments, and resources will be posted here throughout the semester.</p>
    </section>
    {%- endunless -%}

    <!-- Back Navigation -->
    <nav class="course-nav">
      <a href="/teaching/" class="btn-minimal btn-minimal--ghost">
        <i class="fas fa-arrow-left"></i>
        Back to All Courses
      </a>
    </nav>

  </div>
</div>

<style>
/* =============================================================================
   Course Materials Page - Minimal Styles
   Scoped to .course-wrapper for modularity
   ============================================================================= */

.course-wrapper {
  --transition-duration: 200ms;
  --transition-easing: cubic-bezier(0.4, 0, 0.2, 1);
  
  /* Accent color variations */
  --color-blue: var(--global-theme-color);
  --color-blue-soft: rgba(var(--global-theme-color-rgb), 0.1);
  --color-green: #10b981;
  --color-green-soft: rgba(16, 185, 129, 0.1);
  --color-purple: #8b5cf6;
  --color-purple-soft: rgba(139, 92, 246, 0.1);
  --color-amber: #f59e0b;
  --color-amber-soft: rgba(245, 158, 11, 0.1);
}

/* Course Header */
.course-header {
  padding-bottom: 2rem;
  margin-bottom: 2rem;
  border-bottom: 1px solid var(--global-divider-color);
}

.course-header__desc {
  max-width: 720px;
  font-size: 1.125rem;
  margin: 0 0 1.5rem 0;
}

.course-header__meta {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
}

/* Content Sections */
.content-section {
  margin-bottom: 3rem;
}

/* Section Label Color Variants */
.section-label__icon--blue {
  background: var(--color-blue-soft);
  color: var(--color-blue);
}

.section-label__icon--green {
  background: var(--color-green-soft);
  color: var(--color-green);
}

.section-label__icon--purple {
  background: var(--color-purple-soft);
  color: var(--color-purple);
}

/* Logistics Grid */
.logistics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1.5rem;
  padding: 1.5rem;
  border-bottom: 1px solid var(--global-divider-color);
}

.logistics-item {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.logistics-item__label {
  opacity: 0.7;
}

.logistics-item__value {
  font-weight: 500;
  color: var(--global-text-color);
}

/* Schedule Table */
.schedule-table-wrapper {
  overflow-x: auto;
}

.schedule-table {
  width: 100%;
  border-collapse: collapse;
}

.schedule-table th,
.schedule-table td {
  padding: 1rem 1.5rem;
  text-align: left;
  border-bottom: 1px solid var(--global-divider-color);
}

.schedule-table th {
  font-size: 0.8125rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--global-text-color-light);
  background: transparent;
}

.schedule-table tr:last-child td {
  border-bottom: none;
}

.lecture-num {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 2rem;
  padding: 0.25rem 0.625rem;
  background: var(--color-blue-soft);
  color: var(--color-blue);
  border-radius: 6px;
  font-size: 0.8125rem;
  font-weight: 600;
}

/* Material Cards */
.material-card {
  display: flex;
  flex-direction: column;
  padding: 1.25rem;
}

.material-card__content {
  flex: 1;
}

.material-card__title {
  margin: 0 0 0.5rem 0;
  font-size: 1.0625rem;
}

.material-card__desc {
  margin: 0 0 1rem 0;
  font-size: 0.9375rem;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.material-card__due {
  display: inline-flex;
  align-items: center;
  gap: 0.375rem;
  padding: 0.375rem 0.75rem;
  background: var(--color-amber-soft);
  color: var(--color-amber);
  border-radius: 6px;
  font-size: 0.8125rem;
  font-weight: 500;
}

.material-card__actions {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid var(--global-divider-color);
}

/* Card Type Indicators */
.material-card--lecture { border-top: 3px solid var(--color-blue); }
.material-card--assignment { border-top: 3px solid var(--color-green); }
.material-card--resource { border-top: 3px solid var(--color-purple); }

/* Empty State */
.empty-state {
  text-align: center;
  padding: 4rem 2rem;
  background: var(--global-card-bg-color);
  border-radius: 16px;
  border: 2px dashed var(--global-divider-color);
}

.empty-state__icon {
  font-size: 2.5rem;
  color: var(--global-text-color-light);
  opacity: 0.4;
  margin-bottom: 1rem;
}

.empty-state__title {
  margin: 0 0 0.5rem 0;
}

.empty-state__desc {
  margin: 0;
  max-width: 400px;
  margin-inline: auto;
}

/* Navigation */
.course-nav {
  margin-top: 3rem;
  padding-top: 2rem;
  border-top: 1px solid var(--global-divider-color);
}

/* Animation Delays */
.content-section:nth-child(2) { animation-delay: 50ms; }
.content-section:nth-child(3) { animation-delay: 100ms; }
.content-section:nth-child(4) { animation-delay: 150ms; }
.content-section:nth-child(5) { animation-delay: 200ms; }

/* Responsive */
@media (max-width: 640px) {
  .logistics-grid {
    grid-template-columns: 1fr;
    gap: 1rem;
    padding: 1rem;
  }
  
  .schedule-table th,
  .schedule-table td {
    padding: 0.75rem 1rem;
  }
  
  .material-card__actions {
    flex-direction: column;
  }
  
  .material-card__actions .btn-minimal {
    width: 100%;
    justify-content: center;
  }
}
</style>